generator client {
  provider        = "prisma-client"
  output          = "../src/prisma"
  previewFeatures = ["postgresqlExtensions"]
}

datasource db {
  provider   = "postgresql"
  extensions = [citext]
}

model Board {
  id          String   @id @default(uuid()) @map("id")
  title       String   @map("title")
  seq         Int      @default(0) @map("seq")
  ownerUserId String   @map("owner_user_id")
  createdAt   DateTime @default(now()) @map("created_at")

  invite BoardInvite[]

  @@index([ownerUserId], map: "idx_boards_owner_user_id")
  @@map("boarddb.boards")
}

enum InviteType {
  TEMPORARY
  PERMANENT

  @@map("invite_type")
}

model BoardInvite {
  boardId   String     @map("board_id")
  type      InviteType @map("type")
  tokenHash Bytes      @map("token_hash")
  expiresAt DateTime?  @map("expires_at")
  createdAt DateTime   @default(now()) @map("created_at")

  board Board @relation(fields: [boardId], references: [id], onDelete: Cascade)

  @@id([boardId, type])
  @@unique([tokenHash], map: "ux_board_invites_token_hash")
  @@index([expiresAt], map: "idx_board_invites_expires_at")
  @@map("boarddb.board_invites")
}
